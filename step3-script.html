<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ­¥éª¤3ï¼šåˆ›æ„è„šæœ¬</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            position: relative;
        }

        .header {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            color: white;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .step-indicator {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 20px;
        }

        .step-number {
            width: 60px;
            height: 60px;
            background: linear-gradient(45deg, #f093fb, #f5576c);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: bold;
            margin-right: 20px;
            animation: pulse 2s infinite;
        }

        .step-info h1 {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .step-info p {
            opacity: 0.9;
            font-size: 1.1rem;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 400px;
            gap: 30px;
            margin-bottom: 30px;
        }

        .script-panel {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .panel-title {
            font-size: 1.4rem;
            font-weight: 700;
            color: #333;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
        }

        .panel-title .icon {
            margin-right: 10px;
            font-size: 1.5rem;
        }

        .script-generation {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .script-generation::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: generating 2s infinite;
        }

        .generation-title {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .generation-subtitle {
            opacity: 0.9;
            margin-bottom: 15px;
        }

        .progress-bar {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            height: 8px;
            overflow: hidden;
            margin-bottom: 10px;
        }

        .progress-fill {
            background: linear-gradient(45deg, #48bb78, #38a169);
            height: 100%;
            width: 0%;
            border-radius: 10px;
            transition: width 0.3s ease;
        }

        .progress-text {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        .script-content {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            min-height: 400px;
            position: relative;
        }

        .script-scene {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
            border-left: 4px solid #667eea;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.5s ease;
        }

        .script-scene.visible {
            opacity: 1;
            transform: translateY(0);
        }

        .scene-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .scene-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: #333;
        }

        .scene-duration {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .scene-content {
            line-height: 1.6;
            color: #555;
        }

        .scene-visual {
            background: #e8f4fd;
            border-radius: 8px;
            padding: 12px;
            margin-top: 10px;
            font-style: italic;
            color: #0066cc;
            border-left: 3px solid #0066cc;
        }

        .scene-audio {
            background: #fff3cd;
            border-radius: 8px;
            padding: 12px;
            margin-top: 10px;
            color: #856404;
            border-left: 3px solid #ffc107;
        }

        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .info-card {
            background: white;
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .project-summary {
            background: linear-gradient(45deg, #48bb78, #38a169);
            color: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 15px;
        }

        .summary-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }

        .summary-item:last-child {
            margin-bottom: 0;
            padding-bottom: 0;
            border-bottom: none;
        }

        .summary-label {
            font-weight: 500;
            opacity: 0.9;
        }

        .summary-value {
            font-weight: 600;
        }

        .script-stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-item {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 15px;
            text-align: center;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9rem;
            color: #666;
        }

        .action-buttons {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .action-btn {
            padding: 12px 20px;
            border: none;
            border-radius: 10px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .primary-btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
        }

        .primary-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        }

        .secondary-btn {
            background: #f8f9fa;
            color: #333;
            border: 1px solid #dee2e6;
        }

        .secondary-btn:hover {
            background: #e9ecef;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .nav-btn {
            padding: 15px 30px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .back-btn {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            backdrop-filter: blur(10px);
        }

        .back-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .next-btn {
            background: linear-gradient(45deg, #f093fb, #f5576c);
            color: white;
            opacity: 0.5;
            cursor: not-allowed;
        }

        .next-btn.enabled {
            opacity: 1;
            cursor: pointer;
        }

        .next-btn.enabled:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(245, 87, 108, 0.3);
        }

        @keyframes pulse {
            0% {
                box-shadow: 0 0 0 0 rgba(240, 147, 251, 0.4);
            }
            50% {
                box-shadow: 0 0 0 10px rgba(240, 147, 251, 0.1);
            }
            100% {
                box-shadow: 0 0 0 0 rgba(240, 147, 251, 0);
            }
        }

        @keyframes generating {
            0% {
                left: -100%;
            }
            100% {
                left: 100%;
            }
        }

        @keyframes typewriter {
            from {
                width: 0;
            }
            to {
                width: 100%;
            }
        }

        .typewriter {
            overflow: hidden;
            border-right: 2px solid #667eea;
            white-space: nowrap;
            animation: typewriter 2s steps(40, end);
        }

        @media (max-width: 1024px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .sidebar {
                order: -1;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="step-indicator">
                <div class="step-number">3</div>
                <div class="step-info">
                    <h1>ğŸ“ åˆ›æ„è„šæœ¬</h1>
                    <p>AIæ™ºèƒ½ç”Ÿæˆä¸“ä¸šè„šæœ¬ï¼Œæ‰“é€ å®Œç¾å†…å®¹æ¡†æ¶</p>
                </div>
            </div>
        </div>

        <div class="main-content">
            <div class="script-panel">
                <div class="panel-title">
                    <span class="icon">ğŸ¬</span>
                    è„šæœ¬ç”Ÿæˆ
                </div>

                <div class="script-generation" id="generationStatus">
                    <div class="generation-title">ğŸ¤– AIæ­£åœ¨åˆ›ä½œè„šæœ¬...</div>
                    <div class="generation-subtitle">åŸºäºåˆ†æç»“æœç”Ÿæˆä¸ªæ€§åŒ–å†…å®¹</div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                    <div class="progress-text" id="progressText">å‡†å¤‡ä¸­...</div>
                </div>

                <div class="script-content" id="scriptContent">
                    <div style="text-align: center; color: #999; padding: 50px 0;">
                        <div style="font-size: 3rem; margin-bottom: 20px;">ğŸ“„</div>
                        <div>è„šæœ¬ç”Ÿæˆä¸­ï¼Œè¯·ç¨å€™...</div>
                    </div>
                </div>
            </div>

            <div class="sidebar">
                <div class="info-card">
                    <div class="panel-title">
                        <span class="icon">ğŸ“Š</span>
                        é¡¹ç›®æ¦‚è§ˆ
                    </div>

                    <div class="project-summary" id="projectSummary">
                        <!-- é¡¹ç›®ä¿¡æ¯å°†åœ¨è¿™é‡Œæ˜¾ç¤º -->
                    </div>

                    <div class="script-stats" id="scriptStats">
                        <!-- è„šæœ¬ç»Ÿè®¡å°†åœ¨è¿™é‡Œæ˜¾ç¤º -->
                    </div>

                    <div class="action-buttons">
                        <button class="action-btn primary-btn" onclick="regenerateScript()">ğŸ”„ é‡æ–°ç”Ÿæˆ</button>
                        <button class="action-btn secondary-btn" onclick="exportScript()">ğŸ“¥ å¯¼å‡ºè„šæœ¬</button>
                        <button class="action-btn secondary-btn" onclick="previewScript()">ğŸ‘ï¸ é¢„è§ˆæ•ˆæœ</button>
                    </div>
                </div>

                <div class="info-card">
                    <div class="panel-title">
                        <span class="icon">ğŸ’¡</span>
                        åˆ›ä½œæç¤º
                    </div>

                    <div style="background: #f8f9fa; border-radius: 12px; padding: 20px;">
                        <div style="margin-bottom: 15px;">
                            <strong>ğŸ¯ æ ¸å¿ƒè¦ç‚¹ï¼š</strong>
                            <ul style="margin: 10px 0 0 20px; line-height: 1.6;">
                                <li>å¼€å¤´3ç§’æŠ“ä½æ³¨æ„åŠ›</li>
                                <li>ä¿æŒèŠ‚å¥ç´§å‡‘æœ‰è¶£</li>
                                <li>ç»“å°¾ç•™ä¸‹æ·±åˆ»å°è±¡</li>
                            </ul>
                        </div>
                        
                        <div style="margin-bottom: 15px;">
                            <strong>ğŸ“± å¹³å°ä¼˜åŒ–ï¼š</strong>
                            <ul style="margin: 10px 0 0 20px; line-height: 1.6;">
                                <li>é€‚é…ç«–å±è§‚çœ‹ä¹ æƒ¯</li>
                                <li>å­—å¹•æ¸…æ™°æ˜“è¯»</li>
                                <li>éŸ³æ•ˆé…åˆæ°å½“</li>
                            </ul>
                        </div>
                        
                        <div>
                            <strong>ğŸ”¥ çˆ†æ¬¾å…ƒç´ ï¼š</strong>
                            <ul style="margin: 10px 0 0 20px; line-height: 1.6;">
                                <li>æƒ…æ„Ÿå…±é¸£ç‚¹</li>
                                <li>äº’åŠ¨å¼•å¯¼è¯­</li>
                                <li>è®°å¿†ç‚¹è®¾è®¡</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="navigation">
            <button class="nav-btn back-btn" onclick="goBack()">â† ä¸Šä¸€æ­¥</button>
            <button class="nav-btn next-btn" id="nextBtn" onclick="goToNext()">ä¸‹ä¸€æ­¥ï¼šåˆ¶ä½œå®Œæˆ â†’</button>
        </div>
    </div>

    <script>
        let projectData = {};
        let scriptGenerated = false;
        let currentScript = null;

        // è„šæœ¬æ¨¡æ¿
        const scriptTemplates = {
            'æƒ…æ„Ÿå…±é¸£å‹': {
                scenes: [
                    {
                        title: 'å¼€åœºå¼•å…¥',
                        duration: '0-5ç§’',
                        content: 'æ¸©æš–çš„ç”»é¢å¼€åœºï¼Œé…åˆè½»æŸ”çš„èƒŒæ™¯éŸ³ä¹ï¼Œè¥é€ èˆ’é€‚çš„è§‚çœ‹æ°›å›´ã€‚',
                        visual: 'ç”»é¢ï¼šæ¸©é¦¨çš„ç”Ÿæ´»åœºæ™¯ï¼ŒæŸ”å’Œçš„å…‰çº¿',
                        audio: 'éŸ³ä¹ï¼šè½»æŸ”çš„é’¢ç´æ›²ï¼Œè¥é€ æ¸©æš–æ°›å›´'
                    },
                    {
                        title: 'æƒ…æ„Ÿé“ºå«',
                        duration: '5-15ç§’',
                        content: 'é€šè¿‡çœŸå®çš„ç”Ÿæ´»ç‰‡æ®µï¼Œå¼•å‡ºè§‚ä¼—çš„æƒ…æ„Ÿå…±é¸£ç‚¹ï¼Œå»ºç«‹æƒ…æ„Ÿè¿æ¥ã€‚',
                        visual: 'ç”»é¢ï¼šæ—¥å¸¸ç”Ÿæ´»çš„çœŸå®ç¬é—´ï¼Œç»†è…»çš„æƒ…æ„Ÿè¡¨è¾¾',
                        audio: 'æ—ç™½ï¼šæ¸©æš–çš„å£°éŸ³ï¼Œå¨“å¨“é“æ¥çš„å™è¿°'
                    },
                    {
                        title: 'æ•…äº‹é«˜æ½®',
                        duration: '15-40ç§’',
                        content: 'å±•å¼€æ ¸å¿ƒæ•…äº‹æƒ…èŠ‚ï¼Œé€šè¿‡èµ·æ‰¿è½¬åˆçš„å™äº‹ç»“æ„ï¼Œè¾¾åˆ°æƒ…æ„Ÿé«˜æ½®ã€‚',
                        visual: 'ç”»é¢ï¼šæƒ…æ„Ÿå†²çªä¸å’Œè§£ï¼Œè¡¨æƒ…ç‰¹å†™',
                        audio: 'éŸ³ä¹ï¼šæƒ…æ„Ÿæ¸å¼ºï¼Œé…åˆæ•…äº‹èŠ‚å¥'
                    },
                    {
                        title: 'å‡åç»“å°¾',
                        duration: '40-60ç§’',
                        content: 'å‡åä¸»é¢˜ï¼Œç»™è§‚ä¼—ç•™ä¸‹æ·±åˆ»å°è±¡å’Œæ­£å‘çš„æƒ…æ„Ÿä½“éªŒã€‚',
                        visual: 'ç”»é¢ï¼šæ¸©æš–çš„ç»“å±€ï¼Œå¸Œæœ›çš„è±¡å¾',
                        audio: 'éŸ³ä¹ï¼šæ¸©æš–çš„å°¾å£°ï¼Œç•™ä¸‹ä½™éŸµ'
                    }
                ],
                stats: {
                    totalDuration: '60ç§’',
                    sceneCount: '4ä¸ª',
                    emotionalIntensity: '85%',
                    engagementRate: '92%'
                }
            },
            'çƒ­ç‚¹è¿½è¸ªå‹': {
                scenes: [
                    {
                        title: 'çƒ­ç‚¹åˆ‡å…¥',
                        duration: '0-3ç§’',
                        content: 'å¿«é€Ÿåˆ‡å…¥å½“å‰çƒ­ç‚¹è¯é¢˜ï¼Œç”¨é†’ç›®çš„æ ‡é¢˜å’Œç”»é¢æŠ“ä½æ³¨æ„åŠ›ã€‚',
                        visual: 'ç”»é¢ï¼šçƒ­ç‚¹ç›¸å…³çš„é†’ç›®è§†è§‰å…ƒç´ ',
                        audio: 'éŸ³æ•ˆï¼šç´§å¼ åˆºæ¿€çš„å¼€åœºéŸ³æ•ˆ'
                    },
                    {
                        title: 'è§‚ç‚¹é˜è¿°',
                        duration: '3-20ç§’',
                        content: 'æå‡ºç‹¬ç‰¹çš„è§‚ç‚¹å’Œè§è§£ï¼Œä¸å…¶ä»–å†…å®¹å½¢æˆå·®å¼‚åŒ–ã€‚',
                        visual: 'ç”»é¢ï¼šæ•°æ®å›¾è¡¨ï¼Œå…³é”®ä¿¡æ¯å±•ç¤º',
                        audio: 'æ—ç™½ï¼šæ¸…æ™°æœ‰åŠ›çš„è§‚ç‚¹è¡¨è¾¾'
                    },
                    {
                        title: 'æ·±åº¦åˆ†æ',
                        duration: '20-45ç§’',
                        content: 'æ·±å…¥åˆ†æçƒ­ç‚¹èƒŒåçš„åŸå› å’Œå½±å“ï¼Œæä¾›æœ‰ä»·å€¼çš„æ´å¯Ÿã€‚',
                        visual: 'ç”»é¢ï¼šåˆ†æè¿‡ç¨‹ï¼Œé€»è¾‘å±•ç¤º',
                        audio: 'éŸ³ä¹ï¼šæ€è€ƒæ°›å›´çš„èƒŒæ™¯éŸ³'
                    },
                    {
                        title: 'äº’åŠ¨å¼•å¯¼',
                        duration: '45-60ç§’',
                        content: 'å¼•å¯¼è§‚ä¼—å‚ä¸è®¨è®ºï¼Œæå‡ºé—®é¢˜æˆ–å‘¼åè¡ŒåŠ¨ã€‚',
                        visual: 'ç”»é¢ï¼šäº’åŠ¨æç¤ºï¼Œå…³æ³¨å¼•å¯¼',
                        audio: 'æ—ç™½ï¼šçƒ­æƒ…çš„äº’åŠ¨é‚€è¯·'
                    }
                ],
                stats: {
                    totalDuration: '60ç§’',
                    sceneCount: '4ä¸ª',
                    viralPotential: '95%',
                    topicRelevance: '98%'
                }
            },
            'æ•™è‚²ç§‘æ™®å‹': {
                scenes: [
                    {
                        title: 'é—®é¢˜æå‡º',
                        duration: '0-8ç§’',
                        content: 'æå‡ºä¸€ä¸ªå¼•äººæ€è€ƒçš„é—®é¢˜æˆ–ç°è±¡ï¼Œæ¿€å‘è§‚ä¼—çš„æ±‚çŸ¥æ¬²ã€‚',
                        visual: 'ç”»é¢ï¼šé—®é¢˜ç›¸å…³çš„è§†è§‰å±•ç¤º',
                        audio: 'æ—ç™½ï¼šå¼•äººæ€è€ƒçš„é—®é¢˜è¡¨è¿°'
                    },
                    {
                        title: 'çŸ¥è¯†è®²è§£',
                        duration: '8-35ç§’',
                        content: 'ç³»ç»Ÿæ€§åœ°è®²è§£ç›¸å…³çŸ¥è¯†ç‚¹ï¼Œç”¨é€šä¿—æ˜“æ‡‚çš„æ–¹å¼è§£é‡Šå¤æ‚æ¦‚å¿µã€‚',
                        visual: 'ç”»é¢ï¼šå›¾è¡¨ã€åŠ¨ç”»ã€å®ä¾‹æ¼”ç¤º',
                        audio: 'æ—ç™½ï¼šæ¸…æ™°çš„çŸ¥è¯†è®²è§£'
                    },
                    {
                        title: 'å®ä¾‹åº”ç”¨',
                        duration: '35-50ç§’',
                        content: 'é€šè¿‡å…·ä½“å®ä¾‹å±•ç¤ºçŸ¥è¯†çš„å®é™…åº”ç”¨ï¼Œå¢å¼ºç†è§£å’Œè®°å¿†ã€‚',
                        visual: 'ç”»é¢ï¼šå®é™…åº”ç”¨åœºæ™¯å±•ç¤º',
                        audio: 'éŸ³æ•ˆï¼šé…åˆæ¼”ç¤ºçš„éŸ³æ•ˆ'
                    },
                    {
                        title: 'æ€»ç»“å›é¡¾',
                        duration: '50-60ç§’',
                        content: 'æ€»ç»“æ ¸å¿ƒè¦ç‚¹ï¼Œæä¾›è¿›ä¸€æ­¥å­¦ä¹ çš„å»ºè®®å’Œèµ„æºã€‚',
                        visual: 'ç”»é¢ï¼šè¦ç‚¹æ€»ç»“ï¼Œå­¦ä¹ èµ„æºå±•ç¤º',
                        audio: 'æ—ç™½ï¼šæ€»ç»“æ€§çš„è¡¨è¿°'
                    }
                ],
                stats: {
                    totalDuration: '60ç§’',
                    sceneCount: '4ä¸ª',
                    knowledgeDensity: '91%',
                    comprehensibility: '87%'
                }
            },
            'å¨±ä¹æç¬‘å‹': {
                scenes: [
                    {
                        title: 'æç¬‘å¼€åœº',
                        duration: '0-5ç§’',
                        content: 'ç”¨å‡ºäººæ„æ–™çš„æç¬‘å…ƒç´ å¿«é€ŸæŠ“ä½è§‚ä¼—æ³¨æ„åŠ›ã€‚',
                        visual: 'ç”»é¢ï¼šå¤¸å¼ çš„è¡¨æƒ…å’ŒåŠ¨ä½œ',
                        audio: 'éŸ³æ•ˆï¼šæç¬‘çš„éŸ³æ•ˆé…åˆ'
                    },
                    {
                        title: 'ç¬‘ç‚¹é“ºå«',
                        duration: '5-25ç§’',
                        content: 'é€šè¿‡ä¸€ç³»åˆ—å°ç¬‘ç‚¹ä¸ºä¸»è¦ç¬‘ç‚¹åšé“ºå«ï¼Œä¿æŒè§‚ä¼—å…´è¶£ã€‚',
                        visual: 'ç”»é¢ï¼šè¿ç»­çš„æç¬‘åœºæ™¯',
                        audio: 'éŸ³ä¹ï¼šè½»å¿«çš„èƒŒæ™¯éŸ³ä¹'
                    },
                    {
                        title: 'é«˜æ½®çˆ†ç¬‘',
                        duration: '25-45ç§’',
                        content: 'é‡Šæ”¾æœ€å¤§çš„ç¬‘ç‚¹ï¼Œé€šè¿‡åè½¬æˆ–å¤¸å¼ è¾¾åˆ°æç¬‘é«˜æ½®ã€‚',
                        visual: 'ç”»é¢ï¼šæœ€æç¬‘çš„åœºæ™¯å’Œè¡¨æƒ…',
                        audio: 'éŸ³æ•ˆï¼šå¼ºçƒˆçš„æç¬‘éŸ³æ•ˆ'
                    },
                    {
                        title: 'ä½™éŸµæ”¶å°¾',
                        duration: '45-60ç§’',
                        content: 'ç”¨æ¸©é¦¨æˆ–æ„å¤–çš„ç»“å°¾ç»™è§‚ä¼—ç•™ä¸‹æ·±åˆ»å°è±¡ã€‚',
                        visual: 'ç”»é¢ï¼šæ¸©é¦¨æˆ–æ„å¤–çš„ç»“å°¾ç”»é¢',
                        audio: 'éŸ³ä¹ï¼šæ¸©æš–çš„ç»“å°¾éŸ³ä¹'
                    }
                ],
                stats: {
                    totalDuration: '60ç§’',
                    sceneCount: '4ä¸ª',
                    funnyIndex: '94%',
                    shareability: '90%'
                }
            },
            'åˆ›æ–°çªç ´å‹': {
                scenes: [
                    {
                        title: 'è§†è§‰å†²å‡»',
                        duration: '0-8ç§’',
                        content: 'ç”¨å‰æ‰€æœªè§çš„è§†è§‰æ•ˆæœæˆ–åˆ›æ–°æŠ€æœ¯éœ‡æ’¼å¼€åœºã€‚',
                        visual: 'ç”»é¢ï¼šåˆ›æ–°çš„è§†è§‰ç‰¹æ•ˆ',
                        audio: 'éŸ³æ•ˆï¼šç§‘æŠ€æ„Ÿçš„éŸ³æ•ˆ'
                    },
                    {
                        title: 'åˆ›æ„å±•ç¤º',
                        duration: '8-30ç§’',
                        content: 'å±•ç¤ºæ ¸å¿ƒçš„åˆ›æ–°ç†å¿µæˆ–æŠ€æœ¯ï¼Œçªå‡ºç‹¬ç‰¹æ€§å’Œå…ˆè¿›æ€§ã€‚',
                        visual: 'ç”»é¢ï¼šåˆ›æ–°æŠ€æœ¯çš„å±•ç¤º',
                        audio: 'æ—ç™½ï¼šä¸“ä¸šçš„æŠ€æœ¯è§£è¯´'
                    },
                    {
                        title: 'ä½“éªŒäº’åŠ¨',
                        duration: '30-50ç§’',
                        content: 'è®©è§‚ä¼—å‚ä¸åˆ°åˆ›æ–°ä½“éªŒä¸­ï¼Œæ„Ÿå—æŠ€æœ¯å¸¦æ¥çš„å˜åŒ–ã€‚',
                        visual: 'ç”»é¢ï¼šäº’åŠ¨ä½“éªŒçš„è¿‡ç¨‹',
                        audio: 'éŸ³æ•ˆï¼šäº’åŠ¨åé¦ˆéŸ³æ•ˆ'
                    },
                    {
                        title: 'æœªæ¥å±•æœ›',
                        duration: '50-60ç§’',
                        content: 'å±•æœ›æŠ€æœ¯çš„æœªæ¥åº”ç”¨å’Œå‘å±•å‰æ™¯ï¼Œæ¿€å‘æƒ³è±¡ã€‚',
                        visual: 'ç”»é¢ï¼šæœªæ¥ç§‘æŠ€çš„æƒ³è±¡',
                        audio: 'éŸ³ä¹ï¼šå……æ»¡å¸Œæœ›çš„éŸ³ä¹'
                    }
                ],
                stats: {
                    totalDuration: '60ç§’',
                    sceneCount: '4ä¸ª',
                    innovationLevel: '96%',
                    techAdvancement: '88%'
                }
            },
            'å“è´¨ç²¾è‡´å‹': {
                scenes: [
                    {
                        title: 'ç²¾è‡´å¼€åœº',
                        duration: '0-10ç§’',
                        content: 'ç”¨é«˜å“è´¨çš„ç”»é¢å’Œç²¾è‡´çš„ç»†èŠ‚å±•ç°ä¸“ä¸šæ°´å‡†ã€‚',
                        visual: 'ç”»é¢ï¼šé«˜æ¸…ç²¾è‡´çš„è§†è§‰å‘ˆç°',
                        audio: 'éŸ³ä¹ï¼šé«˜å“è´¨çš„éŸ³ä¹åˆ¶ä½œ'
                    },
                    {
                        title: 'å“è´¨å±•ç¤º',
                        duration: '10-35ç§’',
                        content: 'æ·±å…¥å±•ç¤ºäº§å“æˆ–å†…å®¹çš„å“è´¨ç»†èŠ‚ï¼Œçªå‡ºç²¾å·¥ç»†ä½œã€‚',
                        visual: 'ç”»é¢ï¼šç»†èŠ‚ç‰¹å†™ï¼Œå“è´¨å±•ç¤º',
                        audio: 'æ—ç™½ï¼šä¸“ä¸šçš„å“è´¨è§£è¯´'
                    },
                    {
                        title: 'ä»·å€¼ä½“ç°',
                        duration: '35-50ç§’',
                        content: 'ä½“ç°å“è´¨èƒŒåçš„ä»·å€¼å’Œæ„ä¹‰ï¼Œå»ºç«‹å“ç‰Œè®¤çŸ¥ã€‚',
                        visual: 'ç”»é¢ï¼šä»·å€¼ä½“ç°çš„åœºæ™¯',
                        audio: 'éŸ³ä¹ï¼šä½“ç°ä»·å€¼çš„éŸ³ä¹'
                    },
                    {
                        title: 'å“ç‰Œå‡å',
                        duration: '50-60ç§’',
                        content: 'å‡åå“ç‰Œå½¢è±¡ï¼Œç•™ä¸‹é«˜ç«¯ä¸“ä¸šçš„å°è±¡ã€‚',
                        visual: 'ç”»é¢ï¼šå“ç‰Œå½¢è±¡çš„å‡å',
                        audio: 'éŸ³ä¹ï¼šå“ç‰Œä¸»é¢˜éŸ³ä¹'
                    }
                ],
                stats: {
                    totalDuration: '60ç§’',
                    sceneCount: '4ä¸ª',
                    qualityScore: '98%',
                    brandValue: '93%'
                }
            }
        };

        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            loadProjectData();
            setTimeout(() => {
                startScriptGeneration();
            }, 1000);
        });

        // åŠ è½½é¡¹ç›®æ•°æ®
        function loadProjectData() {
            const saved = localStorage.getItem('currentProject');
            if (saved) {
                projectData = JSON.parse(saved);
                
                if (!projectData.step2Completed) {
                    alert('è¯·å…ˆå®Œæˆç†è§£åˆ†ææ­¥éª¤ï¼');
                    window.location.href = 'step2-analysis.html';
                    return;
                }
                
                displayProjectSummary();
            } else {
                alert('æœªæ‰¾åˆ°é¡¹ç›®ä¿¡æ¯ï¼Œè¯·é‡æ–°å¼€å§‹ï¼');
                window.location.href = 'workflow-flow.html';
            }
        }

        // æ˜¾ç¤ºé¡¹ç›®æ¦‚è§ˆ
        function displayProjectSummary() {
            const summaryContainer = document.getElementById('projectSummary');
            summaryContainer.innerHTML = `
                <div class="summary-item">
                    <span class="summary-label">é¡¹ç›®åç§°</span>
                    <span class="summary-value">${projectData.title}</span>
                </div>
                <div class="summary-item">
                    <span class="summary-label">åˆ›æ„ç±»å‹</span>
                    <span class="summary-value">${projectData.selectedIdea.title}</span>
                </div>
                <div class="summary-item">
                    <span class="summary-label">ç›®æ ‡å¹³å°</span>
                    <span class="summary-value">çŸ­è§†é¢‘å¹³å°</span>
                </div>
                <div class="summary-item">
                    <span class="summary-label">é¢„è®¡æ—¶é•¿</span>
                    <span class="summary-value">60ç§’</span>
                </div>
            `;
        }

        // å¼€å§‹è„šæœ¬ç”Ÿæˆ
        function startScriptGeneration() {
            const progressSteps = [
                { progress: 20, text: 'åˆ†æåˆ›æ„ç±»å‹...' },
                { progress: 40, text: 'æ„å»ºæ•…äº‹æ¡†æ¶...' },
                { progress: 60, text: 'ä¼˜åŒ–åœºæ™¯è®¾è®¡...' },
                { progress: 80, text: 'å®Œå–„ç»†èŠ‚æè¿°...' },
                { progress: 100, text: 'è„šæœ¬ç”Ÿæˆå®Œæˆï¼' }
            ];

            let currentStep = 0;
            const progressFill = document.getElementById('progressFill');
            const progressText = document.getElementById('progressText');

            const updateProgress = () => {
                if (currentStep < progressSteps.length) {
                    const step = progressSteps[currentStep];
                    progressFill.style.width = step.progress + '%';
                    progressText.textContent = step.text;
                    currentStep++;
                    
                    setTimeout(updateProgress, 1000);
                } else {
                    // ç”Ÿæˆå®Œæˆï¼Œæ˜¾ç¤ºè„šæœ¬
                    setTimeout(() => {
                        document.getElementById('generationStatus').style.display = 'none';
                        generateScript();
                    }, 500);
                }
            };

            updateProgress();
        }

        // ç”Ÿæˆè„šæœ¬
        function generateScript() {
            const ideaType = projectData.selectedIdea.title;
            const template = scriptTemplates[ideaType];
            
            if (!template) {
                console.error('æœªæ‰¾åˆ°å¯¹åº”çš„è„šæœ¬æ¨¡æ¿');
                return;
            }

            currentScript = template;
            displayScript(template);
            displayScriptStats(template.stats);
            
            // å¯ç”¨ä¸‹ä¸€æ­¥æŒ‰é’®
            setTimeout(() => {
                scriptGenerated = true;
                document.getElementById('nextBtn').classList.add('enabled');
                
                // ä¿å­˜è„šæœ¬ç»“æœ
                projectData.scriptResults = template;
                projectData.step3Completed = true;
                localStorage.setItem('currentProject', JSON.stringify(projectData));
            }, 2000);
        }

        // æ˜¾ç¤ºè„šæœ¬å†…å®¹
        function displayScript(template) {
            const scriptContent = document.getElementById('scriptContent');
            scriptContent.innerHTML = '';

            template.scenes.forEach((scene, index) => {
                setTimeout(() => {
                    const sceneElement = document.createElement('div');
                    sceneElement.className = 'script-scene';
                    sceneElement.innerHTML = `
                        <div class="scene-header">
                            <div class="scene-title">åœºæ™¯ ${index + 1}ï¼š${scene.title}</div>
                            <div class="scene-duration">${scene.duration}</div>
                        </div>
                        <div class="scene-content">${scene.content}</div>
                        <div class="scene-visual">ğŸ“¹ ${scene.visual}</div>
                        <div class="scene-audio">ğŸµ ${scene.audio}</div>
                    `;
                    scriptContent.appendChild(sceneElement);
                    
                    setTimeout(() => {
                        sceneElement.classList.add('visible');
                    }, 100);
                }, index * 600);
            });
        }

        // æ˜¾ç¤ºè„šæœ¬ç»Ÿè®¡
        function displayScriptStats(stats) {
            const statsContainer = document.getElementById('scriptStats');
            const statEntries = Object.entries(stats);
            
            statEntries.forEach(([key, value], index) => {
                setTimeout(() => {
                    const statItem = document.createElement('div');
                    statItem.className = 'stat-item';
                    
                    let label = '';
                    switch(key) {
                        case 'totalDuration': label = 'æ€»æ—¶é•¿'; break;
                        case 'sceneCount': label = 'åœºæ™¯æ•°'; break;
                        case 'emotionalIntensity': label = 'æƒ…æ„Ÿå¼ºåº¦'; break;
                        case 'engagementRate': label = 'å‚ä¸åº¦'; break;
                        case 'viralPotential': label = 'ä¼ æ’­æ½œåŠ›'; break;
                        case 'topicRelevance': label = 'è¯é¢˜ç›¸å…³'; break;
                        case 'knowledgeDensity': label = 'çŸ¥è¯†å¯†åº¦'; break;
                        case 'comprehensibility': label = 'ç†è§£åº¦'; break;
                        case 'funnyIndex': label = 'æç¬‘æŒ‡æ•°'; break;
                        case 'shareability': label = 'åˆ†äº«åº¦'; break;
                        case 'innovationLevel': label = 'åˆ›æ–°åº¦'; break;
                        case 'techAdvancement': label = 'æŠ€æœ¯å…ˆè¿›'; break;
                        case 'qualityScore': label = 'å“è´¨åˆ†æ•°'; break;
                        case 'brandValue': label = 'å“ç‰Œä»·å€¼'; break;
                        default: label = key;
                    }
                    
                    statItem.innerHTML = `
                        <div class="stat-value">${value}</div>
                        <div class="stat-label">${label}</div>
                    `;
                    statsContainer.appendChild(statItem);
                }, index * 300);
            });
        }

        // é‡æ–°ç”Ÿæˆè„šæœ¬
        function regenerateScript() {
            if (!scriptGenerated) {
                alert('è„šæœ¬è¿˜åœ¨ç”Ÿæˆä¸­ï¼Œè¯·ç¨ç­‰ï¼');
                return;
            }
            
            if (confirm('ç¡®å®šè¦é‡æ–°ç”Ÿæˆè„šæœ¬å—ï¼Ÿè¿™å°†è¦†ç›–å½“å‰å†…å®¹ã€‚')) {
                document.getElementById('generationStatus').style.display = 'block';
                document.getElementById('scriptContent').innerHTML = `
                    <div style="text-align: center; color: #999; padding: 50px 0;">
                        <div style="font-size: 3rem; margin-bottom: 20px;">ğŸ“„</div>
                        <div>é‡æ–°ç”Ÿæˆä¸­ï¼Œè¯·ç¨å€™...</div>
                    </div>
                `;
                document.getElementById('scriptStats').innerHTML = '';
                
                scriptGenerated = false;
                document.getElementById('nextBtn').classList.remove('enabled');
                
                setTimeout(() => {
                    startScriptGeneration();
                }, 1000);
            }
        }

        // å¯¼å‡ºè„šæœ¬
        function exportScript() {
            if (!scriptGenerated) {
                alert('è„šæœ¬è¿˜æœªç”Ÿæˆå®Œæˆï¼');
                return;
            }
            
            let scriptText = `é¡¹ç›®ï¼š${projectData.title}\n`;
            scriptText += `åˆ›æ„ç±»å‹ï¼š${projectData.selectedIdea.title}\n\n`;
            
            currentScript.scenes.forEach((scene, index) => {
                scriptText += `åœºæ™¯ ${index + 1}ï¼š${scene.title} (${scene.duration})\n`;
                scriptText += `${scene.content}\n`;
                scriptText += `è§†è§‰ï¼š${scene.visual}\n`;
                scriptText += `éŸ³é¢‘ï¼š${scene.audio}\n\n`;
            });
            
            const blob = new Blob([scriptText], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${projectData.title}-è„šæœ¬.txt`;
            a.click();
            URL.revokeObjectURL(url);
        }

        // é¢„è§ˆè„šæœ¬
        function previewScript() {
            if (!scriptGenerated) {
                alert('è„šæœ¬è¿˜æœªç”Ÿæˆå®Œæˆï¼');
                return;
            }
            
            alert('é¢„è§ˆåŠŸèƒ½å¼€å‘ä¸­ï¼Œæ•¬è¯·æœŸå¾…ï¼');
        }

        // è¿”å›ä¸Šä¸€æ­¥
        function goBack() {
            window.location.href = 'step2-analysis.html';
        }

        // å‰å¾€ä¸‹ä¸€æ­¥
        function goToNext() {
            if (!scriptGenerated) {
                alert('è„šæœ¬è¿˜æœªç”Ÿæˆå®Œæˆï¼Œè¯·ç¨ç­‰ï¼');
                return;
            }

            // æ›´æ–°é¡¹ç›®è¿›åº¦
            projectData.currentStep = 4;
            localStorage.setItem('currentProject', JSON.stringify(projectData));

            // è·³è½¬åˆ°ä¸‹ä¸€æ­¥
            window.location.href = 'step4-complete.html';
        }

        // é”®ç›˜å¿«æ·é”®
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                goBack();
            }
            
            if (e.key === 'Enter' && scriptGenerated) {
                goToNext();
            }
            
            if (e.key === 'r' || e.key === 'R') {
                regenerateScript();
            }
        });
    </script>
</body>
</html>